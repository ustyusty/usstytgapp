<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–∞–ª–µ—Ä–µ—è –∫–∞—Ä—Ç–∏–Ω–æ–∫</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--tg-theme-bg-color, #ffffff);
            color: var(--tg-theme-text-color, #000000);
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            padding: 15px;
            text-align: center;
            background: var(--tg-theme-secondary-bg-color, #f0f0f0);
            border-bottom: 1px solid var(--tg-theme-section-separator-color, #e0e0e0);
        }

        .gallery-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
        }

        .image-wrapper {
            width: 100%;
            max-width: 400px;
            height: 400px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            background: var(--tg-theme-secondary-bg-color, #f8f8f8);
        }

        .gallery-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .gallery-image:hover {
            transform: scale(1.02);
        }

        .navigation {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .nav-btn {
            background: var(--tg-theme-button-color, #0088cc);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
        }

        .nav-btn:disabled {
            background: var(--tg-theme-section-separator-color, #cccccc);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .nav-btn:active {
            transform: scale(0.95);
        }

        .counter {
            font-size: 14px;
            color: var(--tg-theme-hint-color, #999999);
            margin-bottom: 10px;
        }

        .image-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            text-align: center;
        }

        .swipe-hint {
            position: absolute;
            bottom: 20px;
            font-size: 12px;
            color: var(--tg-theme-hint-color, #999999);
            text-align: center;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes slideOut {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(-50px); }
        }

        .slide-in {
            animation: slideIn 0.3s ease;
        }

        .slide-out {
            animation: slideOut 0.3s ease;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 480px) {
            .image-wrapper {
                height: 300px;
            }
            
            .nav-btn {
                padding: 10px 20px;
                min-width: 100px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üñºÔ∏è –ì–∞–ª–µ—Ä–µ—è</h1>
    </div>

    <div class="gallery-container">
        <div class="counter">
            <span id="current">1</span> / <span id="total">0</span>
        </div>
        
        <div class="image-title" id="imageTitle">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        
        <div class="image-wrapper">
            <img id="galleryImage" class="gallery-image" src="" alt="–ì–∞–ª–µ—Ä–µ—è">
        </div>

        <div class="navigation">
            <button class="nav-btn" id="prevBtn" onclick="previousImage()">‚¨ÖÔ∏è –ù–∞–∑–∞–¥</button>
            <button class="nav-btn" id="nextBtn" onclick="nextImage()">–í–ø–µ—Ä–µ–¥ ‚û°Ô∏è</button>
        </div>

        <div class="swipe-hint">
            üí° –ú–æ–∂–Ω–æ –ª–∏—Å—Ç–∞—Ç—å —Å–≤–∞–π–ø–æ–º –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–µ
        </div>
    </div>

    <script>
        // Telegram Web App API
        const tg = window.Telegram.WebApp;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        tg.expand();
        tg.enableClosingConfirmation();
        tg.MainButton.setText("–ü–æ–¥–µ–ª–∏—Ç—å—Å—è").hide();

        // –ö–æ–ª–ª–µ–∫—Ü–∏—è –∫–∞—Ä—Ç–∏–Ω–æ–∫
        const images = [
            {
                url: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
                title: "–ì–æ—Ä–Ω—ã–π –ø–µ–π–∑–∞–∂"
            },
            {
                url: "https://images.unsplash.com/photo-1439066615861-d1af74d74000?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
                title: "–õ–µ—Å–Ω–∞—è —Ç—Ä–æ–ø–∞"
            },
            {
                url: "https://images.unsplash.com/photo-1469474968028-56623f02e42e?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
                title: "–ó–∞–∫–∞—Ç –Ω–∞–¥ –æ–∑–µ—Ä–æ–º"
            },
            {
                url: "https://images.unsplash.com/photo-1682686581556-a3f0ee0ed556?ixlib=rb-4.0.3&ixid=M3wxMjA3fDF8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
                title: "–û–∫–µ–∞–Ω—Å–∫–∏–µ –≤–æ–ª–Ω—ã"
            },
            {
                url: "https://images.unsplash.com/photo-1544551763-46a013bb70d5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80",
                title: "–ì–æ—Ä–æ–¥ –Ω–æ—á—å—é"
            }
        ];

        let currentIndex = 0;
        const galleryImage = document.getElementById('galleryImage');
        const imageTitle = document.getElementById('imageTitle');
        const currentCounter = document.getElementById('current');
        const totalCounter = document.getElementById('total');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–∞–ª–µ—Ä–µ–∏
        function initGallery() {
            totalCounter.textContent = images.length;
            updateImage();
            updateButtons();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –∫–∞—Ä—Ç–∏–Ω–∫–∏
        function updateImage() {
            const image = images[currentIndex];
            
            // –ê–Ω–∏–º–∞—Ü–∏—è —Å–º–µ–Ω—ã –∫–∞—Ä—Ç–∏–Ω–∫–∏
            galleryImage.style.opacity = '0';
            
            setTimeout(() => {
                galleryImage.src = image.url;
                galleryImage.alt = image.title;
                imageTitle.textContent = image.title;
                currentCounter.textContent = currentIndex + 1;
                
                galleryImage.style.opacity = '1';
                galleryImage.classList.add('slide-in');
                
                setTimeout(() => {
                    galleryImage.classList.remove('slide-in');
                }, 300);
            }, 150);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–Ω–æ–ø–æ–∫
        function updateButtons() {
            prevBtn.disabled = currentIndex === 0;
            nextBtn.disabled = currentIndex === images.length - 1;
        }

        // –°–ª–µ–¥—É—é—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞
        function nextImage() {
            if (currentIndex < images.length - 1) {
                currentIndex++;
                updateImage();
                updateButtons();
            }
        }

        // –ü—Ä–µ–¥—ã–¥—É—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞
        function previousImage() {
            if (currentIndex > 0) {
                currentIndex--;
                updateImage();
                updateButtons();
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–≤–∞–π–ø–æ–≤
        let startX = 0;
        let endX = 0;

        galleryImage.addEventListener('touchstart', (e) => {
            startX = e.touches[0].clientX;
        });

        galleryImage.addEventListener('touchend', (e) => {
            endX = e.changedTouches[0].clientX;
            handleSwipe();
        });

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = startX - endX;

            if (Math.abs(diff) > swipeThreshold) {
                if (diff > 0) {
                    // –°–≤–∞–π–ø –≤–ª–µ–≤–æ - —Å–ª–µ–¥—É—é—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞
                    nextImage();
                } else {
                    // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ - –ø—Ä–µ–¥—ã–¥—É—â–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞
                    previousImage();
                }
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft') {
                previousImage();
            } else if (e.key === 'ArrowRight') {
                nextImage();
            }
        });

        // –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è"
        tg.MainButton.onClick(() => {
            const currentImage = images[currentIndex];
            tg.showPopup({
                title: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è",
                message: `–•–æ—á–µ—à—å –ø–æ–¥–µ–ª–∏—Ç—å—Å—è –∫–∞—Ä—Ç–∏–Ω–∫–æ–π "${currentImage.title}"?`,
                buttons: [
                    { type: "default", text: "–û—Ç–º–µ–Ω–∞" },
                    { 
                        type: "ok", 
                        text: "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è",
                        onClick: () => {
                            tg.sendData(JSON.stringify({
                                action: "share_image",
                                image_url: currentImage.url,
                                image_title: currentImage.title
                            }));
                        }
                    }
                ]
            });
        });

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏
        tg.MainButton.show();

        // –ó–∞–ø—É—Å–∫–∞–µ–º –≥–∞–ª–µ—Ä–µ—é
        initGallery();

        // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ç–µ–º—É Telegram
        if (tg.colorScheme === 'dark') {
            document.documentElement.style.setProperty('--tg-theme-bg-color', tg.themeParams.bg_color || '#1c1c1c');
            document.documentElement.style.setProperty('--tg-theme-text-color', tg.themeParams.text_color || '#ffffff');
        }
    </script>
</body>
</html>